# RAG –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å (app1)

–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π RAG –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ–ª—å–∫–æ **Milvus** (–±–µ–∑ PostgreSQL).

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ **–¢–æ–ª—å–∫–æ Milvus** - –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫** - Dense + Sparse –≤–µ–∫—Ç–æ—Ä—ã (BGE-M3)
- ‚úÖ **RRF Fusion** - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- ‚úÖ **Reranking** - Cross-Encoder (BGE-Reranker-v2-m3) –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
- ‚úÖ **Redis –∫—ç—à** - –±—ã—Å—Ç—Ä–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤** - PDF, DOCX, TXT, CSV, XLSX
- ‚úÖ **–£–º–Ω–æ–µ —á–∞–Ω–∫–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚ùå **–ë–µ–∑ PostgreSQL** - –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Milvus
- ‚ùå **–ë–µ–∑ AI Router** - —Ç–æ–ª—å–∫–æ RAG —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app1/
‚îú‚îÄ‚îÄ __init__.py                    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ config.py                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Milvus + Redis)
‚îú‚îÄ‚îÄ logger.py                      # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ milvus_service.py              # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Milvus
‚îú‚îÄ‚îÄ embedding_service.py           # Dense embeddings (BGE-M3)
‚îú‚îÄ‚îÄ sparse_embedding_service.py    # Sparse embeddings (BGE-M3)
‚îú‚îÄ‚îÄ reranker_service.py            # Cross-Encoder Reranking
‚îú‚îÄ‚îÄ preprocessing.py               # –û—á–∏—Å—Ç–∫–∞ –∏ —á–∞–Ω–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
‚îú‚îÄ‚îÄ parser.py                      # –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ vector_search_service.py       # –ü–æ–∏—Å–∫ –≤ Milvus
‚îú‚îÄ‚îÄ fusion.py                      # RRF Fusion –¥–ª—è –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
‚îú‚îÄ‚îÄ rag_service.py                 # –ì–ª–∞–≤–Ω—ã–π RAG —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ main.py                        # FastAPI —Å–µ—Ä–≤–µ—Ä (Granian)
‚îú‚îÄ‚îÄ manage_collections.py          # CLI —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏
‚îú‚îÄ‚îÄ example.py                     # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ client_example.py              # –ü—Ä–∏–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ API
‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example                   # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install torch sentence-transformers FlagEmbedding pymilvus pypdf python-docx openpyxl pydantic-settings
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Milvus –∏ Redis

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Milvus –∏ Redis –∑–∞–ø—É—â–µ–Ω—ã:

```bash
# Milvus
docker run -d --name milvus -p 19530:19530 milvusdb/milvus:latest

# Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
docker run -d --name redis -p 6379:6379 redis:latest
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:

```env
MILVUS_URI=http://localhost:19530
MILVUS_COLLECTION_NAME=rag_documents
EMBEDDING_MODEL=BAAI/bge-m3
EMBEDDING_DIM=1024
EMBEDDING_DEVICE=cuda
CHUNKING_CHUNK_SIZE=2500
CHUNKING_CHUNK_OVERLAP=200
RAG_TOP_K_VECTOR=5
RAG_TOP_K_BM25=5
RAG_MIN_SIMILARITY=0.5
RAG_USE_RERANKING=True
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_ENABLED=True
REDIS_TTL=3600
DEBUG=True
```

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
import asyncio
from app1.rag_service import RAGService

async def main():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    rag = RAGService()
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    with open("document.pdf", "rb") as f:
        content = f.read()
    
    result = await rag.save_document(
        content=content,
        title="My Document",
        source="local",
        filename="document.pdf"
    )
    print(f"Saved: {result}")
    
    # –ü–æ–∏—Å–∫
    search_result = await rag.search(
        query="–ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ?",
        use_hybrid=True,
        use_rrf=True,
        use_reranking=True,  # ‚Üê –í–∫–ª—é—á–∏—Ç—å Cross-Encoder reranking
        use_cache=True,      # ‚Üê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –∫—ç—à
        top_k=5
    )
    
    print(f"–ù–∞–π–¥–µ–Ω–æ: {search_result['count']}")
    print(f"–ò–∑ –∫—ç—à–∞: {search_result.get('from_cache', False)}")
    print(f"Reranking –ø—Ä–∏–º–µ–Ω–µ–Ω: {search_result.get('reranking_applied', False)}")
    
    for idx, result in enumerate(search_result['results'], 1):
        print(f"{idx}. Score: {result['score']:.4f}")
        print(f"   Text: {result['text'][:200]}...")

if __name__ == "__main__":
    asyncio.run(main())
```

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü—Ä–æ—Ü–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞

```
1. –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞ (PDF/DOCX/TXT/CSV/XLSX)
   ‚Üì
2. –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
   ‚Üì
3. –£–º–Ω–æ–µ —á–∞–Ω–∫–∏—Ä–æ–≤–∞–Ω–∏–µ (2500 —Å–∏–º–≤–æ–ª–æ–≤, overlap 200)
   ‚Üì
4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embeddings
   ‚îú‚îÄ‚îÄ Dense (BGE-M3, 1024D)
   ‚îî‚îÄ‚îÄ Sparse (BGE-M3, lexical weights)
   ‚Üì
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Milvus
   ‚îú‚îÄ‚îÄ HNSW –∏–Ω–¥–µ–∫—Å –¥–ª—è dense –≤–µ–∫—Ç–æ—Ä–æ–≤
   ‚îî‚îÄ‚îÄ SPARSE_INVERTED_INDEX –¥–ª—è sparse –≤–µ–∫—Ç–æ—Ä–æ–≤
```

### –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∏—Å–∫–∞

```
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis –∫—ç—à–∞
   ‚îî‚îÄ‚îÄ –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –≤–æ–∑–≤—Ä–∞—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   ‚Üì
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embedding –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞
   ‚Üì
3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
   ‚îú‚îÄ‚îÄ Vector search (HNSW, COSINE)
   ‚îî‚îÄ‚îÄ Sparse search (SPARSE_INVERTED_INDEX, IP)
   ‚Üì
4. RRF Fusion
   ‚îî‚îÄ‚îÄ –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
   ‚Üì
5. Cross-Encoder Reranking (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   ‚îî‚îÄ‚îÄ BGE-Reranker-v2-m3 –¥–ª—è –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–ø-50
   ‚Üì
6. –¢–æ–ø-K —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   ‚Üì
7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Redis –∫—ç—à (TTL: 1 —á–∞—Å)
```

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Milvus Service
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏
- –°–æ–∑–¥–∞–Ω–∏–µ HNSW –∏ SPARSE_INVERTED_INDEX –∏–Ω–¥–µ–∫—Å–æ–≤
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Milvus —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏

### Embedding Service
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è dense –≤–µ–∫—Ç–æ—Ä–æ–≤ (BGE-M3, 1024D)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CUDA/CPU
- –°–∏–Ω–≥–ª—Ç–æ–Ω –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏

### Sparse Embedding Service
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è sparse –≤–µ–∫—Ç–æ—Ä–æ–≤ (BGE-M3)
- Lexical weights –¥–ª—è BM25-–ø–æ–¥–æ–±–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫

### Vector Search Service
- –ü–æ–∏—Å–∫ –≤ Milvus (dense + sparse)
- HNSW –¥–ª—è –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞
- SPARSE_INVERTED_INDEX –¥–ª—è sparse –ø–æ–∏—Å–∫–∞

### Reranker Service
- Cross-Encoder –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (BGE-Reranker-v2-m3)
- –£–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞ –Ω–∞ +20-30%
- –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞—Ä—ã [–∑–∞–ø—Ä–æ—Å, –¥–æ–∫—É–º–µ–Ω—Ç]
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ

### Redis Cache
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- TTL: 1 —á–∞—Å (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- –£—Å–∫–æ—Ä—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –µ—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### RAG Service
- –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, –ø–æ–∏—Å–∫, —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- RRF Fusion –¥–ª—è –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ reranking

## üé® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ

- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫** - Dense + Sparse –≤–µ–∫—Ç–æ—Ä—ã –æ—Ç BGE-M3
- **RRF Fusion** - –ª—É—á—à–µ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **Cross-Encoder Reranking** - —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ +20-30%
- **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –±—ã—Å—Ç—Ä—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **–£–º–Ω–æ–µ —á–∞–Ω–∫–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤** - PDF, DOCX, TXT, CSV, XLSX
- **–õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à embeddings** - —É—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–°–∏–Ω–≥–ª—Ç–æ–Ω—ã** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

### ‚ùå –ß—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–æ

- **PostgreSQL** - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ–æ–±—â–µ
- **AI Router** - –Ω–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å)

## üìù API RAGService

### save_document()
```python
await rag.save_document(
    content: bytes,              # –§–∞–π–ª –≤ –±–∞–π—Ç–∞—Ö
    title: str,                  # –ù–∞–∑–≤–∞–Ω–∏–µ
    source: str,                 # –ò—Å—Ç–æ—á–Ω–∏–∫
    filename: str,               # –ò–º—è —Ñ–∞–π–ª–∞
    collection_name: Optional[str] = None
) -> Dict[str, Any]
```

### search()
```python
await rag.search(
    query: str,                   # –ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
    use_hybrid: bool = True,      # –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫
    use_rrf: bool = True,         # RRF Fusion
    use_reranking: bool = None,   # Reranking (None = –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
    use_cache: bool = True,       # Redis –∫—ç—à
    top_k: int = 5,               # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    collection_name: Optional[str] = None
) -> Dict[str, Any]
```

### delete_document()
```python
await rag.delete_document(
    document_hash: str           # MD5 —Ö–µ—à –¥–æ–∫—É–º–µ–Ω—Ç–∞
) -> Dict[str, Any]
```

## üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏

### –ß–µ—Ä–µ–∑ CLI
–î–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `manage_collections.py`:

```bash
# –°–ø–∏—Å–æ–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–π
python manage_collections.py list

# –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é
python manage_collections.py create my_new_collection

# –£–¥–∞–ª–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é
python manage_collections.py delete my_old_collection

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å (–æ—á–∏—Å—Ç–∏—Ç—å) –∫–æ–ª–ª–µ–∫—Ü–∏—é
python manage_collections.py recreate rag_documents
```

### –ß–µ—Ä–µ–∑ API

- **GET /collections** - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **POST /collections/{name}** - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é
- **DELETE /collections/{name}** - —É–¥–∞–ª–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é

## üî¨ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Milvus** - –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **BGE-M3** - –º–æ–¥–µ–ª—å –¥–ª—è dense + sparse embeddings
- **PyTorch** - deep learning framework
- **FlagEmbedding** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è BGE-M3
- **pypdf, python-docx, openpyxl** - –ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **GPU (CUDA)**: ~100-200 —Ç–µ–∫—Å—Ç–æ–≤/—Å–µ–∫ (batch_size=64)
- **CPU**: ~20-50 —Ç–µ–∫—Å—Ç–æ–≤/—Å–µ–∫ (batch_size=32)
- **–ü–æ–∏—Å–∫**: <100ms –¥–ª—è —Ç–æ–ø-5 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üêõ –û—Ç–ª–∞–¥–∫–∞

–í–∫–ª—é—á–∏—Ç–µ DEBUG —Ä–µ–∂–∏–º –≤ `.env`:
```env
DEBUG=True
```

–õ–æ–≥–∏ –±—É–¥—É—Ç –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

| –§–æ—Ä–º–∞—Ç | –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ | –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ |
|--------|------------|------------|
| PDF | .pdf | pypdf |
| Word | .docx, .doc | python-docx |
| Excel | .xlsx, .xls | openpyxl |
| CSV | .csv | csv (built-in) |
| Text | .txt | built-in |

### –†–∞–∑–º–µ—Ä—ã —á–∞–Ω–∫–æ–≤

- **chunk_size**: 2500 —Å–∏–º–≤–æ–ª–æ–≤ (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤)
- **overlap**: 200 —Å–∏–º–≤–æ–ª–æ–≤ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É —á–∞–Ω–∫–∞–º–∏)

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: **100 –ú–ë**
- –î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ —á–∞–Ω–∫–∞: **–¥–æ 8192 —Ç–æ–∫–µ–Ω–æ–≤** (BGE-M3)
- –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å dense –≤–µ–∫—Ç–æ—Ä–∞: **1024** (BGE-M3)

## üîÆ –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
2. **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –ø–æ–∏—Å–∫ –ø–æ –¥–∞—Ç–µ, –∞–≤—Ç–æ—Ä—É –∏ —Ç.–¥.
3. **Streaming search** - –ø–æ—Ç–æ–∫–æ–≤–∞—è –æ—Ç–¥–∞—á–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** - –¥–æ–±–∞–≤–∏—Ç—å PostgreSQL –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
5. **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å** - —É–ª—É—á—à–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤
6. **Query expansion** - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏
7. **Automatic parameter tuning** - –∞–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–∏—Å–∫–∞

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

RAG Microservice Team
